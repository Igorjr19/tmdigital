<div
  [ngClass]="{
    'surface-card p-4 shadow-2 border-round w-full lg:w-6 m-auto mt-4':
      !insideModal,
    'p-1': insideModal,
  }"
>
  <p-toast></p-toast>

  <div
    class="flex justify-content-between align-items-center mb-4 border-bottom-1 surface-border pb-3"
  >
    <h2 class="m-0 text-900 font-bold">
      {{ isEditMode() ? I18N.LEAD.FORM.TITLE_EDIT : I18N.LEAD.FORM.TITLE_NEW }}
    </h2>
    <p-button
      icon="pi pi-arrow-left"
      [label]="I18N.COMMON.BACK"
      [text]="true"
      severity="secondary"
      (onClick)="goBack()"
    ></p-button>
  </div>

  <form
    [formGroup]="form"
    (ngSubmit)="onSubmit()"
    class="grid formgrid p-fluid"
  >
    <!-- Nome -->
    <div class="field col-12 md:col-6">
      <label for="name" class="font-medium text-900"
        >{{ I18N.LEAD.FORM.LABELS.NAME }}
        <span class="text-red-500">*</span></label
      >
      <input
        id="name"
        type="text"
        pInputText
        formControlName="name"
        [placeholder]="I18N.LEAD.FORM.PLACEHOLDERS.NAME"
        class="w-full"
        [ngClass]="{
          'ng-invalid ng-dirty':
            form.get('name')?.invalid && form.get('name')?.dirty,
        }"
      />
      @if (form.get('name')?.invalid && form.get('name')?.dirty) {
        <small class="p-error block">
          {{ I18N.LEAD.FORM.LABELS.NAME }}
          {{ I18N.LEAD.FORM.VALIDATION.REQUIRED }}
        </small>
      }
    </div>

    <!-- Documento -->
    <div class="field col-12 md:col-6">
      <label for="document" class="font-medium text-900"
        >{{ I18N.LEAD.FORM.LABELS.DOCUMENT }}
        <span class="text-red-500">*</span></label
      >
      <input
        id="document"
        type="text"
        pInputText
        formControlName="document"
        [placeholder]="I18N.LEAD.FORM.PLACEHOLDERS.DOCUMENT"
        class="w-full"
        [ngClass]="{
          'ng-invalid ng-dirty':
            form.get('document')?.invalid && form.get('document')?.dirty,
        }"
      />
      @if (form.get('document')?.invalid && form.get('document')?.dirty) {
        <small class="p-error block">
          {{ I18N.LEAD.FORM.LABELS.DOCUMENT }}
          {{ I18N.LEAD.FORM.VALIDATION.REQUIRED }}
        </small>
      }
    </div>

    <!-- Status -->
    <div class="field col-12 md:col-6">
      <label for="status" class="font-medium text-900"
        >{{ I18N.LEAD.FORM.LABELS.STATUS }}
        <span class="text-red-500">*</span></label
      >
      <p-select
        id="status"
        [options]="statusOptions"
        formControlName="status"
        [placeholder]="I18N.LEAD.FORM.PLACEHOLDERS.SELECT"
        optionLabel="label"
        optionValue="value"
        styleClass="w-full"
        appendTo="body"
      ></p-select>
    </div>

    <!-- Potencial -->
    <div class="field col-12 md:col-6">
      <label for="estimatedPotential" class="font-medium text-900">{{
        I18N.LEAD.FORM.LABELS.POTENTIAL
      }}</label>
      <p-inputNumber
        id="estimatedPotential"
        formControlName="estimatedPotential"
        mode="currency"
        currency="BRL"
        locale="pt-BR"
        [placeholder]="I18N.LEAD.FORM.PLACEHOLDERS.POTENTIAL"
        styleClass="w-full"
        class="w-full"
      ></p-inputNumber>
    </div>

    <!-- Fornecedor Atual -->
    <div class="field col-12">
      <label for="currentSupplier" class="font-medium text-900">{{
        I18N.LEAD.FORM.LABELS.CURRENT_SUPPLIER
      }}</label>
      <span class="p-input-icon-left w-full">
        <i class="pi pi-briefcase"></i>
        <input
          id="currentSupplier"
          type="text"
          pInputText
          formControlName="currentSupplier"
          [placeholder]="I18N.LEAD.FORM.PLACEHOLDERS.CURRENT_SUPPLIER"
          class="w-full"
        />
      </span>
    </div>

    <!-- Notas -->
    <div class="field col-12">
      <label for="notes" class="font-medium text-900">{{
        I18N.LEAD.FORM.LABELS.NOTES
      }}</label>
      <textarea
        id="notes"
        pTextarea
        formControlName="notes"
        rows="4"
        [placeholder]="I18N.LEAD.FORM.PLACEHOLDERS.NOTES"
        class="w-full resize-none"
      ></textarea>
    </div>

    <!-- BotÃµes -->
    <div
      class="col-12 flex justify-content-end gap-3 mt-4 pt-3 border-top-1 surface-border"
    >
      <p-button
        [label]="I18N.COMMON.CANCEL"
        icon="pi pi-times"
        styleClass="p-button-outlined p-button-secondary"
        (onClick)="goBack()"
      ></p-button>
      <p-button
        [label]="I18N.COMMON.SAVE"
        icon="pi pi-save"
        type="submit"
        [loading]="leadsFacade.loading()"
        [disabled]="form.invalid"
      ></p-button>
    </div>
  </form>

  @if (isEditMode() && leadId && lead()) {
    <div class="mt-4 pt-3 border-top-1 surface-border">
      <app-lead-properties
        [leadId]="leadId"
        [properties]="leadProperties"
      ></app-lead-properties>
    </div>
  }
</div>
